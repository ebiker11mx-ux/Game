<!DOCTYPE html><html lang="en">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1, user-scalable=no" />
<title>Ultimate Mobile Obby</title>
<style>
html,body{margin:0;padding:0;width:100%;height:100%;overflow:hidden;background:linear-gradient(#6fd3ff,#baf0ff);font-family:system-ui}
canvas{display:block}
#hud{position:absolute;top:12px;left:50%;transform:translateX(-50%);background:rgba(0,0,0,.35);color:#fff;padding:8px 16px;border-radius:14px;font-size:15px}
#joystick{position:absolute;bottom:30px;left:30px;width:130px;height:130px;border-radius:50%;background:rgba(255,255,255,.25);touch-action:none}
#stick{position:absolute;left:45px;top:45px;width:40px;height:40px;border-radius:50%;background:#fff}
#jump{position:absolute;bottom:45px;right:40px;width:75px;height:75px;border-radius:50%;border:none;font-size:22px;color:#fff;background:linear-gradient(#ff7a7a,#e84141)}
</style>
</head>
<body>
<div id="hud">OBBY · Level 1 · CP 1</div>
<div id="joystick"><div id="stick"></div></div>
<button id="jump">⬆</button>
<script src="https://cdn.jsdelivr.net/npm/three@0.160.0/build/three.min.js"></script>
<script>
let scene,camera,renderer,player;let platforms=[],checkpoints=[],hazards=[],spinners=[];let velocity=new THREE.Vector3();let canJump=false;let joyX=0,joyY=0;let camYaw=0;let gravity=.013,speed=.12,jumpPower=.28;let level=1,cpIndex=0;
init();animate();
function init(){scene=new THREE.Scene();scene.background=new THREE.Color(0x87ceeb);camera=new THREE.PerspectiveCamera(65,innerWidth/innerHeight,.1,400);renderer=new THREE.WebGLRenderer({antialias:true});renderer.setSize(innerWidth,innerHeight);renderer.setPixelRatio(Math.min(devicePixelRatio,2));document.body.appendChild(renderer.domElement);
scene.add(new THREE.AmbientLight(0xffffff,.6));let sun=new THREE.DirectionalLight(0xffffff,1);sun.position.set(15,25,10);scene.add(sun);
player=new THREE.Mesh(new THREE.CapsuleGeometry(.35,.8,8,16),new THREE.MeshStandardMaterial({color:0xff4d4d}));player.position.set(0,1,0);scene.add(player);
buildLevel();setupJoystick();setupJump();addCameraSwipe();addResize();}function buildLevel(){platforms=[];checkpoints=[];hazards=[];spinners=[];scene.children=scene.children.filter(o=>o.isLight||o===player); addPlatform(0,0,0,8,1,8,0xffffff); let cols=[0xff3b3b,0xffa801,0x2ed573,0x1e90ff,0xbe2edd]; for(let i=0;i<5;i++){addPlatform(i4,1+i1.1,-i*4,3,.6,3,cols[i]);} addHazard(20,1.2,-20);addSpinner(12,1.5,-12); addCheckpoint(8,2,-8);addCheckpoint(20,2,-20);updateHUD();}

function addPlatform(x,y,z,w,h,d,c){let m=new THREE.Mesh(new THREE.BoxGeometry(w,h,d),new THREE.MeshStandardMaterial({color:c}));m.position.set(x,y+h/2,z);m.userData={w,h,d,type:'solid'};scene.add(m);platforms.push(m)} function addHazard(x,y,z){let m=new THREE.Mesh(new THREE.BoxGeometry(3,.4,3),new THREE.MeshStandardMaterial({color:0xff0000,emissive:0x550000}));m.position.set(x,y,z);m.userData={w:3,h:.4,d:3,type:'kill'};scene.add(m);hazards.push(m)} function addSpinner(x,y,z){let arm=new THREE.Mesh(new THREE.BoxGeometry(6,.3,.5),new THREE.MeshStandardMaterial({color:0xffa801}));arm.position.set(x,y,z);arm.userData={speed:.05};scene.add(arm);spinners.push(arm)} function addCheckpoint(x,y,z){let m=new THREE.Mesh(new THREE.TorusGeometry(.5,.15,12,20),new THREE.MeshStandardMaterial({color:0x2ecc71,emissive:0x116633}));m.position.set(x,y,z);m.rotation.x=Math.PI/2;scene.add(m);checkpoints.push(m)}

function setupJoystick(){let joy=document.getElementById('joystick'),stick=document.getElementById('stick'),active=false; joy.addEventListener('touchstart',()=>active=true); joy.addEventListener('touchend',()=>{active=false;joyX=joyY=0;stick.style.left='45px';stick.style.top='45px'}); joy.addEventListener('touchmove',e=>{if(!active)return;let r=joy.getBoundingClientRect();let t=e.touches[0];let x=t.clientX-r.left-65;let y=t.clientY-r.top-65;let d=Math.min(45,Math.hypot(x,y));let a=Math.atan2(y,x);joyX=Math.cos(a)(d/45);joyY=Math.sin(a)(d/45);stick.style.left=45+joyX45+'px';stick.style.top=45+joyY45+'px'}); } function setupJump(){document.getElementById('jump').addEventListener('touchstart',()=>{if(canJump){velocity.y=jumpPower;canJump=false}})} function addCameraSwipe(){let lastX=null;window.addEventListener('touchmove',e=>{if(e.touches.length>1)return;if(lastX!==null){camYaw+=(e.touches[0].clientX-lastX)*.005}lastX=e.touches[0].clientX});window.addEventListener('touchend',()=>lastX=null)}

function animate(){requestAnimationFrame(animate); spinners.forEach(s=>s.rotation.y+=s.userData.speed); let f=new THREE.Vector3(Math.sin(camYaw),0,Math.cos(camYaw));let r=new THREE.Vector3(Math.cos(camYaw),0,-Math.sin(camYaw));player.position.addScaledVector(f,-joyYspeed);player.position.addScaledVector(r,joyXspeed); velocity.y-=gravity;player.position.y+=velocity.y;canJump=false; platforms.forEach(p=>{if(hit(p)){player.position.y=p.position.y+p.userData.h/2+.6;velocity.y=0;canJump=true}}); hazards.forEach(h=>{if(hit(h))reset()}); checkpoints.forEach((c,i)=>{if(player.position.distanceTo(c.position)<1){cpIndex=i;updateHUD()}}); if(player.position.y<-15)reset(); let dist=10;camera.position.set(player.position.x+Math.sin(camYaw)*dist,player.position.y+6,player.position.z+Math.cos(camYaw)*dist);camera.lookAt(player.position); renderer.render(scene,camera)}

function hit(o){let{w,h,d}=o.userData;return player.position.x>o.position.x-w/2&&player.position.x<o.position.x+w/2&&player.position.z>o.position.z-d/2&&player.position.z<o.position.z+d/2&&player.position.y-.6<=o.position.y+h/2&&player.position.y-.6>=o.position.y-h/2&&velocity.y<=0} function reset(){if(checkpoints[cpIndex]){player.position.copy(checkpoints[cpIndex].position);player.position.y+=1}else player.position.set(0,1,0);velocity.set(0,0,0)} function updateHUD(){hud.textContent=OBBY · Level ${level} · CP ${cpIndex+1}} function addResize(){addEventListener('resize',()=>{camera.aspect=innerWidth/innerHeight;camera.updateProjectionMatrix();renderer.setSize(innerWidth,innerHeight)})} </script>

</body>
</html>
